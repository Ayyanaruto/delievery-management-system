(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[464],{1955:(e,s,r)=>{Promise.resolve().then(r.bind(r,4242))},4242:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>v});var t=r(5155),d=r(2520),a=r(4085),l=r(5007),i=r(2336),c=r(5785),n=r(745),m=r(371),o=r(5739),u=r(7364),h=r(767);let p=(0,r(7401).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);var x=r(6046),j=r(2115);function v(){let e=(0,x.useRouter)(),s=(0,x.useParams)().id,[r,v]=(0,j.useState)(null),[y,f]=(0,j.useState)(!0),[g,N]=(0,j.useState)(!1),[A,k]=(0,j.useState)({customer:"",customerPhone:"",pickupAddress:"",deliveryAddress:"",items:[""],status:"pending"}),[b,C]=(0,j.useState)({});(0,j.useEffect)(()=>{let e=async()=>{try{f(!0);let e=await o.gH.getById(s);if(!e.success||!e.data)throw Error("Order not found");let r=e.data;v(r),k({customer:r.customer||"",customerPhone:r.customerPhone||"",pickupAddress:r.pickupAddress||"",deliveryAddress:r.deliveryAddress||"",items:r.items&&r.items.length>0?r.items:[""],status:r.status||"pending"})}catch(e){console.error("Error fetching order:",e),C({fetch:e instanceof Error?e.message:"Failed to load order"})}finally{f(!1)}};s&&e()},[s]);let P=()=>{let e={};return A.customer.trim()||(e.customer="Customer name is required"),A.customerPhone.trim()||(e.customerPhone="Customer phone is required"),A.pickupAddress.trim()||(e.pickupAddress="Pickup address is required"),A.deliveryAddress.trim()||(e.deliveryAddress="Delivery address is required"),0===A.items.filter(e=>e.trim()).length&&(e.items="At least one item is required"),C(e),0===Object.keys(e).length},E=async r=>{if(r.preventDefault(),P()){N(!0);try{let r={...A,items:A.items.filter(e=>e.trim())},t=await o.gH.update(s,r);if(t.success)e.push("/admin/orders/".concat(s));else throw Error(t.message||"Failed to update order")}catch(e){console.error("Error updating order:",e),C({submit:e instanceof Error?e.message:"Failed to update order. Please try again."})}finally{N(!1)}}},w=(e,s)=>{k(r=>({...r,[e]:s})),b[e]&&C(s=>({...s,[e]:""}))},F=(e,s)=>{let r=[...A.items];r[e]=s,k(e=>({...e,items:r})),b.items&&C(e=>({...e,items:""}))},O=e=>{if(A.items.length>1){let s=A.items.filter((s,r)=>r!==e);k(e=>({...e,items:s}))}};return y?(0,t.jsx)(d.A,{children:(0,t.jsx)("div",{className:"flex-1 p-8 flex items-center justify-center",children:(0,t.jsx)("p",{children:"Loading order details..."})})}):b.fetch||!r?(0,t.jsx)(d.A,{children:(0,t.jsx)("div",{className:"flex-1 p-8 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-lg text-red-600 mb-4",children:b.fetch||"Order not found"}),(0,t.jsx)(a.$,{onClick:()=>e.push("/admin/dashboard"),children:"Back to Dashboard"})]})})}):(0,t.jsx)(d.A,{children:(0,t.jsxs)("div",{className:"flex-1 space-y-4 p-4 md:p-8 pt-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)(a.$,{variant:"ghost",size:"sm",onClick:()=>e.back(),className:"flex items-center gap-2",children:[(0,t.jsx)(u.A,{className:"h-4 w-4"}),"Back"]}),(0,t.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"Update Order"})]}),(0,t.jsx)("div",{className:"max-w-2xl",children:(0,t.jsxs)(l.Zp,{children:[(0,t.jsx)(l.aR,{children:(0,t.jsx)(l.ZB,{children:"Order Information"})}),(0,t.jsx)(l.Wu,{children:(0,t.jsxs)("form",{onSubmit:E,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.J,{htmlFor:"customer",children:"Customer Name"}),(0,t.jsx)(i.p,{id:"customer",type:"text",value:A.customer,onChange:e=>w("customer",e.target.value),placeholder:"Enter customer name",className:b.customer?"border-red-500":""}),b.customer&&(0,t.jsx)("p",{className:"text-sm text-red-500",children:b.customer})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.J,{htmlFor:"customerPhone",children:"Customer Phone"}),(0,t.jsx)(i.p,{id:"customerPhone",type:"tel",value:A.customerPhone,onChange:e=>w("customerPhone",e.target.value),placeholder:"Enter customer phone",className:b.customerPhone?"border-red-500":""}),b.customerPhone&&(0,t.jsx)("p",{className:"text-sm text-red-500",children:b.customerPhone})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.J,{htmlFor:"pickupAddress",children:"Pickup Address"}),(0,t.jsx)(m.T,{id:"pickupAddress",value:A.pickupAddress,onChange:e=>w("pickupAddress",e.target.value),placeholder:"Enter pickup address",className:b.pickupAddress?"border-red-500":""}),b.pickupAddress&&(0,t.jsx)("p",{className:"text-sm text-red-500",children:b.pickupAddress})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.J,{htmlFor:"deliveryAddress",children:"Delivery Address"}),(0,t.jsx)(m.T,{id:"deliveryAddress",value:A.deliveryAddress,onChange:e=>w("deliveryAddress",e.target.value),placeholder:"Enter delivery address",className:b.deliveryAddress?"border-red-500":""}),b.deliveryAddress&&(0,t.jsx)("p",{className:"text-sm text-red-500",children:b.deliveryAddress})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.J,{children:"Items"}),A.items.map((e,s)=>(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(i.p,{value:e,onChange:e=>F(s,e.target.value),placeholder:"Item ".concat(s+1),className:"flex-1"}),A.items.length>1&&(0,t.jsx)(a.$,{type:"button",variant:"outline",size:"sm",onClick:()=>O(s),children:(0,t.jsx)(h.A,{className:"h-4 w-4"})})]},s)),(0,t.jsxs)(a.$,{type:"button",variant:"outline",size:"sm",onClick:()=>{k(e=>({...e,items:[...e.items,""]}))},className:"flex items-center gap-2",children:[(0,t.jsx)(p,{className:"h-4 w-4"}),"Add Item"]}),b.items&&(0,t.jsx)("p",{className:"text-sm text-red-500",children:b.items})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.J,{htmlFor:"status",children:"Status"}),(0,t.jsxs)(n.l6,{value:A.status,onValueChange:e=>w("status",e),children:[(0,t.jsx)(n.bq,{children:(0,t.jsx)(n.yv,{placeholder:"Select status"})}),(0,t.jsxs)(n.gC,{children:[(0,t.jsx)(n.eb,{value:"pending",children:"Pending"}),(0,t.jsx)(n.eb,{value:"assigned",children:"Assigned"}),(0,t.jsx)(n.eb,{value:"completed",children:"Completed"})]})]})]}),b.submit&&(0,t.jsx)("p",{className:"text-sm text-red-500",children:b.submit}),(0,t.jsxs)("div",{className:"flex gap-4 pt-4",children:[(0,t.jsx)(a.$,{type:"submit",disabled:g,className:"flex-1",children:g?"Updating...":"Update Order"}),(0,t.jsx)(a.$,{type:"button",variant:"outline",onClick:()=>e.back(),className:"flex-1",children:"Cancel"})]})]})})]})})]})})}},7364:(e,s,r)=>{"use strict";r.d(s,{A:()=>t});let t=(0,r(7401).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])}},e=>{var s=s=>e(e.s=s);e.O(0,[365,173,598,961,452,441,517,358],()=>s(1955)),_N_E=e.O()}]);